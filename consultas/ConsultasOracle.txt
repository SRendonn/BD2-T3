CREATE TYPE dep_tipo AS OBJECT(
cod NUMBER(20), 
nom VARCHAR2(25)
);
/
CREATE TABLE departamento OF dep_tipo (
PRIMARY KEY(cod), UNIQUE(nom), nom NOT NULL);
/
CREATE TYPE ciu_tipo AS OBJECT(
cod NUMBER(20),
nom VARCHAR2(25),
midep REF dep_tipo);
/
CREATE TABLE ciudad OF ciu_tipo(
PRIMARY KEY(cod), UNIQUE(nom), nom NOT NULL,
SCOPE FOR (midep) IS departamento, midep NOT NULL);
/
CREATE TYPE prod_tipo AS OBJECT(
cod NUMBER(20),
nom VARCHAR2(25),
precio_unitario NUMBER(10)
);
/
CREATE TABLE producto OF prod_tipo (PRIMARY KEY(cod));
/
CREATE TYPE venta_tipo AS OBJECT(
miprod REF prod_tipo,
nro_unidades number(12)
);
/
CREATE OR REPLACE TYPE vent_varray AS 
VARRAY(200) OF venta_tipo;
/
CREATE TYPE emp_tipo AS OBJECT(
cc NUMBER(15),
nom VARCHAR2(20),
miciu REF ciu_tipo,
ventas vent_varray);
/
CREATE TABLE empleado OF emp_tipo (
PRIMARY KEY(cc), SCOPE FOR (miciu) IS ciudad, miciu NOT NULL);
/
CREATE TABLE historicoventas(
cc NUMBER(15) PRIMARY KEY,
totalacumuladoventas NUMBER(30) NOT NULL
);

INSERT ALL
INTO departamento VALUES (1, 'Antioquia')
INTO departamento VALUES (2, 'Arauca')
INTO departamento VALUES (3, 'Atlántico')
INTO departamento VALUES (4, 'Bogotá')
INTO departamento VALUES (5, 'Bolivar')
INTO departamento VALUES (6, 'Boyacá')
INTO departamento VALUES (7, 'Caldas')
INTO departamento VALUES (8, 'Cundinamarca')
INTO departamento VALUES (9, 'Santander')
INTO departamento VALUES (10, 'Valle del Cauca')
SELECT * FROM dual;

INSERT ALL
INTO ciudad VALUES (1,'Medellín', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =1))
INTO ciudad VALUES (2,'Bello', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =1))
INTO ciudad VALUES (3,'Itagüi', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =1))
INTO ciudad VALUES (4,'Sabaneta', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =1))
INTO ciudad VALUES (5,'Arauca', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =2))
INTO ciudad VALUES (6,'Arauquita', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =2))
INTO ciudad VALUES (7,'Barranquilla', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =3))
INTO ciudad VALUES (8,'Soledad', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =3))
INTO ciudad VALUES (9,'Puerto Colombia', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =3))
INTO ciudad VALUES (10,'Bogotá', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =4))
INTO ciudad VALUES (11,'Catagena', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =5))
INTO ciudad VALUES (12,'Mompós', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =5))
INTO ciudad VALUES (13,'Tunja', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =6))
INTO ciudad VALUES (14,'Sogamoso', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =6))
INTO ciudad VALUES (15,'Villa de Leyva', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =6))
INTO ciudad VALUES (16,'Manizales', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =7))
INTO ciudad VALUES (17,'La Dorada', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =7))
INTO ciudad VALUES (18,'Soacha', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =8))
INTO ciudad VALUES (19,'Chía', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =8))
INTO ciudad VALUES (20,'Girardot', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =8))
INTO ciudad VALUES (21,'Bucaramanga', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =9))
INTO ciudad VALUES (22,'Barrancabermeja', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =9))
INTO ciudad VALUES (23,'Cali', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =10))
INTO ciudad VALUES (24,'Tuluá', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =10))
INTO ciudad VALUES (25,'Buenaventura', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =10))
INTO ciudad VALUES (26,'Yumbo', (SELECT REF(dep) FROM departamento dep WHERE dep.cod =10))
SELECT * FROM dual;


INSERT ALL
INTO producto VALUES (1, 'Gorra', 55000)
INTO producto VALUES (2, 'Sombrero', 76000)
INTO producto VALUES (3, 'Mascarilla', 3000)
INTO producto VALUES (4, 'Bufanda', 62000)
INTO producto VALUES (5, 'Gafas', 46000)
INTO producto VALUES (6, 'Camisa', 93000)
INTO producto VALUES (7, 'Camiseta', 8000)
INTO producto VALUES (8, 'Traje', 30000)
INTO producto VALUES (9, 'Blusa', 29000)
INTO producto VALUES (10, 'Falda', 18000)
INTO producto VALUES (11, 'Vestido', 64000)
INTO producto VALUES (12, 'Tacones', 82000)
INTO producto VALUES (13, 'Tenis', 91000)
INTO producto VALUES (14, 'Medias', 23000)
INTO producto VALUES (15, 'Zapatos', 69000)
SELECT * FROM dual;

-----------------------------------------------------------------------------------------------------------------------

INSERT ALL
INTO empleado VALUES(1, 'Daniel Aranjuez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =1),
vent_varray(
))
INTO empleado VALUES(2, 'Kelly Uribe', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =1),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),3))
)
INTO empleado VALUES(3, 'Eliana Martínez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =1),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),2))
)
INTO empleado VALUES(4, 'Víctor Martínez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =1),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),3))
)
INTO empleado VALUES(5, 'Guillermo Uribe', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =2),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),4))
)
INTO empleado VALUES(6, 'Eliana Salazar', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =3),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =9),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),2))
)
INTO empleado VALUES(7, 'Francisco Dominico', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =3),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),2))
)
INTO empleado VALUES(8, 'Manuel Torres', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =3),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),2))
)
INTO empleado VALUES(9, 'Eliana Dominico', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =3),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),4))
)
INTO empleado VALUES(10, 'Laura Holanda', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =9),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),6))
)
INTO empleado VALUES(11, 'Ramón Gutierrez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =9),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),5))
)
INTO empleado VALUES(12, 'Hada Jazzera', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =9),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =9),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =9),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),2))
)
INTO empleado VALUES(13, 'Unilda Expósito', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =9),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),4))
)
INTO empleado VALUES(14, 'Ismael Salazar', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =10),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),5))
)
INTO empleado VALUES(15, 'Zendaya Salazar', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =10),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =9),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),4))
)
INTO empleado VALUES(16, 'Natalia Holanda', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =11),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),1))
)
INTO empleado VALUES(17, 'William Xhaqiri', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =12),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),4))
)
INTO empleado VALUES(18, 'Francisco López', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =13),
vent_varray(
))
INTO empleado VALUES(19, 'Oscar Salazar', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =13),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),4))
)
INTO empleado VALUES(20, 'Tomás Obrador', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =13),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =9),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),5))
)
INTO empleado VALUES(21, 'Unilda Jazzera', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =13),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),3))
)
INTO empleado VALUES(22, 'Unilda Yon', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =13),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),4))
)
INTO empleado VALUES(23, 'Kelly Yon', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =15),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),6))
)
INTO empleado VALUES(24, 'Yeison Novoa', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =15),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),4))
)
INTO empleado VALUES(25, 'Víctor Uribe', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =15),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),1))
)
INTO empleado VALUES(26, 'Francisco Yon', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =15),
vent_varray(
))
INTO empleado VALUES(27, 'Ramón Bedoya', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =15),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),4))
)
INTO empleado VALUES(28, 'Kelly Jazzera', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =16),
vent_varray(
))
INTO empleado VALUES(29, 'Hada Quispe', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =16),
vent_varray(
))
INTO empleado VALUES(30, 'Quaraz Torres', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =16),
vent_varray(
))
INTO empleado VALUES(31, 'Xakar Xhaqiri', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =17),
vent_varray(
))
INTO empleado VALUES(32, 'William Torres', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =17),
vent_varray(
))
INTO empleado VALUES(33, 'William Dominico', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =17),
vent_varray(
))
INTO empleado VALUES(34, 'Víctor Jazzera', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =18),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),5))
)
INTO empleado VALUES(35, 'Eliana Quispe', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =19),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),6))
)
INTO empleado VALUES(36, 'Bombón Pérez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =20),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),5))
)
INTO empleado VALUES(37, 'Carlos Jazzera', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =20),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),5))
)
INTO empleado VALUES(38, 'Ismael Aranjuez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =20),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),1))
)
INTO empleado VALUES(39, 'Salomé Bedoya', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =21),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =9),1))
)
INTO empleado VALUES(40, 'Oscar Ilizad', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =21),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),6))
)
INTO empleado VALUES(41, 'Daniel Uribe', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =21),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),6))
)
INTO empleado VALUES(42, 'Kelly Rueda', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =23),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),2))
)
INTO empleado VALUES(43, 'Bombón Martínez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =24),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),4))
)
INTO empleado VALUES(44, 'William Martínez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =25),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),6))
)
INTO empleado VALUES(45, 'Ramón Zen', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =25),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =9),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),3))
)
INTO empleado VALUES(46, 'Petra Martínez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =25),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =2),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =1),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),6))
)
INTO empleado VALUES(47, 'Jadara Martínez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =25),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =9),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),5))
)
INTO empleado VALUES(48, 'Víctor Salazar', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =25),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =9),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =9),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =14),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),6))
)
INTO empleado VALUES(49, 'Salomé Gutierrez', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =26),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =8),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),6),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =10),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =12),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),3),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =3),2))
)
INTO empleado VALUES(50, 'Manuel Holanda', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =26),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =13),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =6),4),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =15),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =7),1),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),2),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =5),5),
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =11),1))
)
INTO empleado VALUES(51, 'Ismael Valencia', (SELECT REF(ciu) FROM ciudad ciu WHERE ciu.cod =26),
vent_varray(
venta_tipo((SELECT REF(pro) FROM producto pro WHERE pro.cod =4),2))
)
SELECT * FROM dual;


SELECT e.miciu.nom AS ciudad, SUM(v.nro_unidades*v.miprod.precio_unitario) AS total
FROM empleado e, TABLE(e.ventas) v
WHERE e.miciu.nom = 'Medellín'
GROUP BY e.miciu.nom;

SELECT cedula, total FROM(SELECT e.cc as cedula, SUM(v.nro_unidades*v.miprod.precio_unitario) AS total FROM empleado e, TABLE(e.ventas) v WHERE e.miciu.nom = 'Chía' GROUP BY e.cc ORDER BY total DESC) WHERE rownum=1;

